import{cC as e,U as r,k as t,O as n,m as o,ai as i}from"./vendor.1ee57f36.js";import{b as s}from"./index.4894e768.js";import{a as c,i as u,p as a}from"./aaBoundingBox.960884d4.js";const l=c(-.5,-.5,-.5,.5,.5,.5),f=c(-.5,-.5,0,.5,.5,1),y=c(-.5,-.5,0,.5,.5,.5);let m=d();function d(){return new s(50)}function p(){m=d()}function h(e,r){if("icon"===e.type)return w(e,r);if("object"===e.type)return v(e,r);throw new o("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object")}async function b(r,t){if("icon"===r.type)return w(n=r,t).then((e=>{if(null==n.size)return e;const r=e[0]/e[1];return r>1?[n.size,n.size/r]:[n.size*r,n.size]}));var n;if("object"===r.type)return async function(r,t){return function(r,{isPrimitive:t,width:n,depth:o,height:i}){const s=t?10:1;if(null==n&&null==i&&null==o)return[s*r[0],s*r[1],s*r[2]];const c=e(n,o,i);let u;for(let e=0;e<3;e++){const t=c[e];if(null!=t){u=t/r[e];break}}for(let e=0;e<3;e++)null==c[e]&&(c[e]=r[e]*u);return c}(await v(r,t),r)}(r,t);throw new o("symbol3d:unsupported-symbol-layer","computeLayerSize only works with symbol layers of type Icon and Object")}async function w(e,r){if(e.resource.href)return(n=e.resource.href,i(n,{responseType:"image"}).then((e=>e.data))).then((e=>[e.width,e.height]));var n;if(e.resource.primitive)return t(r)?[r,r]:[256,256];throw new o("symbol3d:invalid-symbol-layer","symbol layers of type Icon must have either an href or a primitive resource")}function v(e,i){return async function(e,i){if(!e.isPrimitive){const t=e.resource.href,n=m.get(t);if(void 0!==n)return r(n);const o=await import("./objectResourceUtils.d5b6d00c.js").then((function(e){return e.o})),i=await o.fetch(t,{disableTextures:!0});return m.put(t,i.referenceBoundingBox),i.referenceBoundingBox}let s=null;if(e.resource&&e.resource.primitive&&(s=u(function(e){switch(e){case"sphere":case"cube":case"diamond":return l;case"cylinder":case"cone":case"inverted-cone":return f;case"tetrahedron":return y;default:return}}(e.resource.primitive)),t(i)))for(let r=0;r<s.length;r++)s[r]*=i;return s?r(s):n(new o("symbol:invalid-resource","The symbol does not have a valid resource"))}(e,i).then((e=>a(e)))}export{p as clearBoundingBoxCache,w as computeIconLayerResourceSize,h as computeLayerResourceSize,b as computeLayerSize,v as computeObjectLayerResourceSize};
