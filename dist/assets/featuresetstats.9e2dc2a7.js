import{U as n,aZ as t,O as r}from"./vendor.1ee57f36.js";import{J as e,l as u,Z as a,F as i,E as c,aj as o,M as s}from"./arcadeUtils.d58d6223.js";import{WhereClause as f}from"./WhereClause.4830c95f.js";import"./number.adca3a71.js";import"./FeatureSetReader.3ec5c3db.js";import"./centroid.b04b550b.js";function d(t,r,e,i,d,m){if(1===i.length){if(a(i[0]))return n(o(t,i[0],s(i[1],-1)));if(c(i[0]))return n(o(t,i[0].toArray(),s(i[1],-1)))}else if(2===i.length){if(a(i[0]))return n(o(t,i[0],s(i[1],-1)));if(c(i[0]))return n(o(t,i[0].toArray(),s(i[1],-1)));if(u(i[0]))return i[0].load().then((n=>l(f.create(i[1],n.getFieldsIndex()),m,d).then((n=>i[0].calculateStatistic(t,n,s(i[2],1e3),r.abortSignal)))))}else if(3===i.length&&u(i[0]))return i[0].load().then((n=>l(f.create(i[1],n.getFieldsIndex()),m,d).then((n=>i[0].calculateStatistic(t,n,s(i[2],1e3),r.abortSignal)))));return n(o(t,i,-1))}function l(e,u,a){try{const r=e.getVariables();if(r.length>0){const n=[];for(let t=0;t<r.length;t++){const e={name:r[t]};n.push(u.evaluateIdentifier(a,e))}return t(n).then((n=>{const t={};for(let e=0;e<r.length;e++)t[r[e]]=n[e];return e.parameters=t,e}))}return n(e)}catch(i){return r(i)}}function m(n){"async"===n.mode&&(n.functions.stdev=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("stdev",r,0,u,t,n)}))},n.functions.variance=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("variance",r,0,u,t,n)}))},n.functions.average=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("mean",r,0,u,t,n)}))},n.functions.mean=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("mean",r,0,u,t,n)}))},n.functions.sum=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("sum",r,0,u,t,n)}))},n.functions.min=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("min",r,0,u,t,n)}))},n.functions.max=function(t,r){return n.standardFunctionAsync(t,r,(function(r,e,u){return d("max",r,0,u,t,n)}))},n.functions.count=function(t,r){return n.standardFunctionAsync(t,r,(function(n,t,r){if(e(r,1,1),u(r[0]))return r[0].count(n.abortSignal);if(a(r[0])||i(r[0]))return r[0].length;if(c(r[0]))return r[0].length();throw new Error("Invalid Parameters for Count")}))})}export{m as registerFunctions};
